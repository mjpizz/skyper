#!/usr/bin/env node

var virtualenv = require("../lib/virtualenv");

var env = virtualenv(require.resolve("../package.json"));

// TODO: add verifications to detect when it is not necessary to reinstall
env.download(function(err) {
  if (err) throw err;
  env.create(function(err) {
    if (err) throw err;
    env.install(function(err) {
      if (err) throw err;
      console.log("Successfully installed Python helpers. On Ubuntu, you may need to 'sudo apt-get install python-dbus python-gobject'.");
    });
  });
});

// This is a soft requirement, so don't kill the npm install.
process.on("uncaughtException", function() {
  console.warn("Python helpers could not be installed, but you can still use core skyper functionality.")
  process.exit(0);
});